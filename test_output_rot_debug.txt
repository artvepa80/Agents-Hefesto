============================= test session starts ==============================
platform linux -- Python 3.11.2, pytest-7.4.4, pluggy-1.6.0 -- /home/user/Agents-Hefesto/venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/user/Agents-Hefesto
configfile: pyproject.toml
plugins: anyio-4.12.1, asyncio-0.23.8, cov-4.1.0
asyncio: mode=Mode.STRICT
collecting ... collected 1 item

tests/telemetry/test_telemetry.py::test_telemetry_rotation FAILED        [100%]

=================================== FAILURES ===================================
___________________________ test_telemetry_rotation ____________________________
tests/telemetry/test_telemetry.py:73: in test_telemetry_rotation
    assert (p.with_suffix(".jsonl.1")).exists()
E   AssertionError: assert False
E    +  where False = <bound method Path.exists of PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl.1')>()
E    +    where <bound method Path.exists of PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl.1')> = PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl.1').exists
E    +      where PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl.1') = <bound method PurePath.with_suffix of PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl')>('.jsonl.1')
E    +        where <bound method PurePath.with_suffix of PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl')> = PosixPath('/tmp/pytest-of-user/pytest-21/test_telemetry_rotation0/t.jsonl').with_suffix

---------- coverage: platform linux, python 3.11.2-final-0 -----------
Name                                                     Stmts   Miss  Cover
----------------------------------------------------------------------------
hefesto/__init__.py                                         25      7    72%
hefesto/__main__.py                                          3      3     0%
hefesto/__version__.py                                       6      2    67%
hefesto/analyzers/__init__.py                                5      5     0%
hefesto/analyzers/best_practices.py                         72     72     0%
hefesto/analyzers/cloud/__init__.py                          7      7     0%
hefesto/analyzers/cloud/arm/__init__.py                     92     92     0%
hefesto/analyzers/cloud/cloudformation/__init__.py         143    143     0%
hefesto/analyzers/cloud/detectors.py                        30     30     0%
hefesto/analyzers/cloud/detectors_insecure_defaults.py      68     68     0%
hefesto/analyzers/cloud/drift/__init__.py                    3      3     0%
hefesto/analyzers/cloud/drift/aws_client.py                 35     35     0%
hefesto/analyzers/cloud/drift/aws_sg.py                    117    117     0%
hefesto/analyzers/cloud/drift/base.py                       23     23     0%
hefesto/analyzers/cloud/finding_schema.py                   17     17     0%
hefesto/analyzers/cloud/graph/__init__.py                    0      0   100%
hefesto/analyzers/cloud/graph/graph_builder.py              46     46     0%
hefesto/analyzers/cloud/graph/resolver.py                  142    142     0%
hefesto/analyzers/cloud/helm/__init__.py                    77     77     0%
hefesto/analyzers/cloud/serverless/__init__.py              77     77     0%
hefesto/analyzers/code_smells.py                            75     75     0%
hefesto/analyzers/complexity.py                             41     41     0%
hefesto/analyzers/devops/__init__.py                        11     11     0%
hefesto/analyzers/devops/dockerfile_analyzer.py             75     75     0%
hefesto/analyzers/devops/groovy_jenkins_analyzer.py         35     35     0%
hefesto/analyzers/devops/json_analyzer.py                  113    113     0%
hefesto/analyzers/devops/makefile_analyzer.py               36     36     0%
hefesto/analyzers/devops/powershell_analyzer.py            123    123     0%
hefesto/analyzers/devops/shell_analyzer.py                  73     73     0%
hefesto/analyzers/devops/sql_analyzer.py                   212    212     0%
hefesto/analyzers/devops/terraform_analyzer.py              39     39     0%
hefesto/analyzers/devops/toml_analyzer.py                  110    110     0%
hefesto/analyzers/devops/yaml_analyzer.py                  110    110     0%
hefesto/analyzers/security.py                               77     77     0%
hefesto/api/__init__.py                                      2      2     0%
hefesto/api/dependencies.py                                  6      6     0%
hefesto/api/main.py                                         41     41     0%
hefesto/api/middleware/__init__.py                          33     33     0%
hefesto/api/middleware/auth.py                              22     22     0%
hefesto/api/middleware/rate_limit.py                        44     44     0%
hefesto/api/routers/__init__.py                              2      2     0%
hefesto/api/routers/analysis.py                            106    106     0%
hefesto/api/routers/findings.py                             77     77     0%
hefesto/api/routers/health.py                               57     57     0%
hefesto/api/schemas/__init__.py                              5      5     0%
hefesto/api/schemas/analysis.py                             91     91     0%
hefesto/api/schemas/common.py                               23     23     0%
hefesto/api/schemas/findings.py                             61     61     0%
hefesto/api/schemas/health.py                               27     27     0%
hefesto/api/services/__init__.py                             3      3     0%
hefesto/api/services/analysis_service.py                    50     50     0%
hefesto/api/services/bigquery_service.py                   167    167     0%
hefesto/api/types.py                                        22     22     0%
hefesto/cli/__init__.py                                      2      2     0%
hefesto/cli/main.py                                        386    386     0%
hefesto/config/__init__.py                                   2      0   100%
hefesto/config/config_manager.py                            43     43     0%
hefesto/config/settings.py                                  52     14    73%
hefesto/config/stripe_config.py                             30     17    43%
hefesto/core/__init__.py                                     9      9     0%
hefesto/core/analysis_models.py                            155    155     0%
hefesto/core/analyzer_engine.py                            211    211     0%
hefesto/core/ast/__init__.py                                 2      2     0%
hefesto/core/ast/generic_ast.py                             63     63     0%
hefesto/core/drift_runner.py                                56     56     0%
hefesto/core/language_detector.py                           27     27     0%
hefesto/core/languages/__init__.py                           3      3     0%
hefesto/core/languages/registry.py                          96     96     0%
hefesto/core/languages/specs.py                             38     38     0%
hefesto/core/models.py                                     256    256     0%
hefesto/core/parsers/__init__.py                             5      5     0%
hefesto/core/parsers/base_parser.py                          9      9     0%
hefesto/core/parsers/parser_factory.py                      14     14     0%
hefesto/core/parsers/python_parser.py                       26     26     0%
hefesto/core/parsers/treesitter_parser.py                   91     91     0%
hefesto/core/providers/__init__.py                           3      3     0%
hefesto/core/providers/base.py                              65     65     0%
hefesto/core/providers/registry.py                          65     65     0%
hefesto/hooks/__init__.py                                    1      1     0%
hefesto/hooks/pre_push.py                                   75     75     0%
hefesto/licensing/__init__.py                                4      0   100%
hefesto/licensing/feature_gate.py                           83     52    37%
hefesto/licensing/key_generator.py                          41     16    61%
hefesto/licensing/license_validator.py                      67     50    25%
hefesto/llm/__init__.py                                     11      2    82%
hefesto/llm/budget_tracker.py                              121     98    19%
hefesto/llm/claude_provider.py                             212    212     0%
hefesto/llm/feedback_logger.py                             113     76    33%
hefesto/llm/gemini_api_client.py                           226    226     0%
hefesto/llm/license_validator.py                            63     63     0%
hefesto/llm/openai_provider.py                             214    214     0%
hefesto/llm/provider.py                                    101    101     0%
hefesto/llm/semantic_analyzer.py                            94     72    23%
hefesto/llm/suggestion_validator.py                        202    164    19%
hefesto/llm/validators.py                                  177    143    19%
hefesto/omega/__init__.py                                   10     10     0%
hefesto/omega/hefesto_enricher.py                           48     48     0%
hefesto/omega/iris_alert_manager.py                         54     54     0%
hefesto/reports/__init__.py                                  4      4     0%
hefesto/reports/html_reporter.py                            51     51     0%
hefesto/reports/json_reporter.py                             9      9     0%
hefesto/reports/text_reporter.py                            87     87     0%
hefesto/security/__init__.py                                 2      0   100%
hefesto/security/masking.py                                106     78    26%
hefesto/security/path_sandbox.py                            12     12     0%
hefesto/telemetry/__init__.py                                0      0   100%
hefesto/telemetry/client.py                                127     47    63%
hefesto/validators/__init__.py                               3      3     0%
hefesto/validators/ci_parity.py                            216    216     0%
hefesto/validators/test_contradictions.py                  211    211     0%
----------------------------------------------------------------------------
TOTAL                                                     7411   6986     6%
Coverage HTML written to dir htmlcov

=========================== short test summary info ============================
FAILED tests/telemetry/test_telemetry.py::test_telemetry_rotation - Assertion...
============================== 1 failed in 3.06s ===============================
